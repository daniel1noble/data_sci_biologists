---
title: "Git, GitHub & Ocean Acidification"
author: "<your name and u number>"
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2:
    code_folding: show
    number_sections: no
    toc: yes
    toc_depth: 6
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# **Introduction**

This tutorial will draw on the skills you have already learnt on data visualisation, data wrangling and NHST to analyse a data set on ocean acidification effects on fish behaviour. However, we'll do that in the context of some new workflows that adopt Git and GitHub. 

Use this Rmarkdown file as your template to complete the tasks outlined within the instructions. There are questions asked in the instructions and here in the RMarkdown file. Answer these as best as you can to document your steps and thinking. There are also a series of coding exercises. 

Throughout we are also going to learn a bit more about how to format Rmarkdown documents. So, pay close attention to the formatting. We're also going to make use of the `bookdown` package now to render your Rmarkdown because, well, it's quite elegant in many ways. Before you start the tasks install the following packages:

```{r loadpacks, message=FALSE, results='hide'}
# Install a load of packages that we'll use. I'll show you a shortcut that I love to use. Try using the p_load function in the "pacman" package. p_load will execute both the install.packages and library commands in one shot so they only need to be used once to install pacman itself.
install.packages("pacman", repos = "http://cran.us.r-project.org")
library(pacman)

# Install bookdown for rendering because we'll need this. While we're at it, lets also install /load the tidyverse
p_load(bookdown, tidyverse, ggforce, flextable) # basically just list all the packages you want here

```

# **Task 1**

### Provide the link to your GitHub Repo 

While the tasks are meant to get you familiar with how GitHub works you should try and make regular commits as you work your way through. We want to see how often you're using Git. Below, within the `[]` brackets provide the link to your GitHub Repo. Just cut and paste it so we know what the repo name is and where it is. 

(My GitHub Repository)[]

By adding the link in the `[]` brackets it will hyperlink "My GitHub Repository". This is how to hyperlink in Rmarkdown documents.

# **Task 2**

This task involves cloning your repository on your computer. Where should we place this repository? While GitHub is somewhat of a cloud storage system because it's keeping record of your commits, files and changes in the cloud it is **not** a backup of your files (note that placing `**` around a word will bold it whereas '*' around a word will italicise it). This is important to recognise! 

>**Question 1**: Why should you not rely on *GitHub* as a backup?

```{r, answer1, echo=TRUE, eval = FALSE}
# Answer the question above here. You may want to explore further and then come back to your reasons as you familiarise yourself

# Use pound symbols to annotate your text.

```

I'd usually suggest placing your repo in a cloud storage system like, *OneDrive*, *Dropbox*, or *GoogleDrive*. These will ensure that all your files are backed up and *GitHub* will provide a record of the detailed history. 

Before moving on you might have noticed that the code block above has a name `answer1` and I've added an argument `echo = TRUE`. It's good to label code blocks with useful names to help you debug when rendering of your document goes wrong (when, not IF!). These names need to all be unique. There are a whole bunch of arguments that you can list within code chunks that tell each chunk what to do. You can look to the great [Rmarkdown cheetsheet](https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf) for more information.

>**Question 2**: In the second code block called `answer1` if we change echo = TRUE to echo = FALSE what will happen to the code block `answer1` when you render it?

```{r answer2, echo=TRUE, eval = FALSE}
## Write your answer here....remember to use '#" in front of your text.
```

**Important**: Notice that `eval = FALSE` for many code chunks. When you complete the tasks. Make sure to change these to `TRUE` otherwise you will find your code does not run!

# **Task 3**

Hopefully you have now successfully cloned down your *GitHub* repo. This is your new working directory from which your project will develop. 

Hopefully you also created and/or downloaded the following files and added them to your cloned repo:

1) created a new RStudio project file in your working directory
2) download the `OA_activitydat_20190302_BIOL3207.csv` from Wattle and add this to a `data/` folder in your repo 
3) Add the template Rmarkdown file, `git_fishes_student.Rmd` that was provided on wattle. You'll use this file to work through the tasks and answer questions. 

**STOP**: Before moving on, it's a good time to establish some good *GitHub* practices. You have just did an important step. It's time stage these files and commit them so that you have a record. Use *GitHub Desktop* to do this. 

This is a very good point to make sure that you understand relative path names fo coding. Wait, "relative what?" 

Your working directory can be considered the 'lowest' level of your project. The starting point, if you will. R needs to know where your files are that you want to load. Many people might be familiar with using the `setwd()` function to tell R where your files are that you need to load. This is problematic because everyone's path to a given working directory is different, and so, your code will not work on others' computers. Even across your own computers!

Lucky, RStudio project files take away the main issue by creating a project file that allows anyone to click on it to open the working directory to the same "spot". Having said that, if you start building structure (i.e., folders) in your working directory or repo than you need to understand how to navigate between folders to load and write files in the places that you want. 

Now that you have already added a `data/` folder to your working directory that you just cloned down think about how you would write some code to load in a data file that is within this folder. There are a few useful shortcuts you can use. For example, if you use `.` it means 'start from the current working directory'. That is the RStudio project file location if you click on a RStudio project. If you use `..` it means "start from the directory or folder one step back from the existing working directory".

>**Question 3**: **How would you write the path name to load in a data file from the data folder?**

Write your answer in the code chunk below:

```{r, loaddata, eval = FALSE, echo=TRUE}

path <- "replace this text with your relative path to a file in the 'data/' folder"
  
data <- read_csv(path)

```

Let's say that you added a new data folder that was inside an output folder (i.e., `output/data`) to your working directory. The purpose of this folder is to store and track your cleaned up data frame after you have done all your data wrangling and corrections. 

>**Question 4**: Using the `write_csv` function how would you write the path name to save this file to `output/data`?

```{r, write, eval = FALSE, echo=TRUE}

path <- "replace this text with your relative path"

write_csv(data, file = path)

```


# **Task 4**

We're ready for some coding! Lets do some coding and wrangling of the `OA_activitydat_20190302_BIOL3207.csv` data that we will use for the workshop. Note above, the `loaddata` code chunk should have already written the code to load the data file. At this point, we're assuming it's in your work space. If not, make sure you run the `loaddata` code chunk. 

First, write some code below to remove missing data

```{r, rmMiss}
# Code to removing missing data from the `OA_activitydat_20190302_BIOL3207.csv` data frame. 

```


Second, drop out irrelevant columns and check that there are no spelling issues in `species` and `treatment` and create a table of summary data that includes 1) the mean, 2) the standard deviation and 3) the sample sizes of unique fish across ALL six fish species for each treatment. You can use the R package [`flextable`](https://ardata-fr.github.io/flextable-book/) to print out the results in a nice neat format!

```{r summaryTab}
# Drop irrelevant columns

# Check spelling in species and treatment but also generate a summary table

# Use flextable to render the summary table in a tidy format

```

**STOP**: Before moving on, it's a good time to establish some good *GitHub* practices. You have just done an important step. It's time to save this file, stage it and commit it so that you have a record. Push these changes up using *GitHub Desktop*. It's important to do this frequently. It's probably not needed after every line of code, but it's good to do this when you have completed an important coding step. Of course, there's no harm in doing it more often. It will provide fine-scale tracking for you!

>**Question 5**: The new version of your Rmarkdown file should now be up on *GitHub*. In the browser window click on your most recent commit. Have a look at the file versioning system. You will notice two files side-by-side. Describe what you notice is being presented online. What do the red and green highlights mean?

```{r answer5, echo=TRUE, eval=FALSE}
## Write your answer here....remember to use '#" in front of your text.
```

# **Task 5**

Ignoring figures can be important because they take up quite a lot of space in your *GitHub* repo. For example, huge data files, or figures can take up a tonne of space. We also might not need to save and track these because we can recreate them with our own code or re-download, process, save and track what we need. 

`.gitignore` file are used to control what *Git* tracks and what it ignores. You should have created a new folder path: `output/figures/`. Write some code now to create a pretty figure using ggplot that shows the difference between control and acidification treatments for each of the fish species in the data set:

```{r, prettyfig}
# ggplot figure showing mean activity for each treatment (Control, OA) for each species.


```

**Stretch Task**: The Clark et al. 2020 paper plots some pretty pictures on their figures. You have access to a folder called "pics/". Add the pics of the difference species from the "pics/" folder to your new plot. 

Use `ggsave` function to save the figure(s) to your new `output/figures/`:

```{r, savefig}
# Use ggsave to save the figure

```

Given that you have added `output/figures/` to your `.gitignore` file describe what you notice about what you see in *GitHub Desktop*. 

>**Question 6**: Assume that you added the `pics/` folder to your working directory to plot pictures of each fish on your figure. Explain why you would want to continue tracking these files on GitHub despite them being .png files?

```{r, answer6}
## Write your answer here....remember to use '#" in front of your text.
```


# **Task 6**
This task involves teaming up with a collaborator. Exchange *GitHub* username details and add each other to your repo. Clone each others' repo on to your computer. Re-run their code. Does it work? If not, correct it for them. Then, lets create a new figure in the code block below that simplifies the one produced in **Task 5**. Instead of all species, lets just plot three of the species (chromis, lemon, and acantho): `

```{r, collabFig, echo=TRUE, eval=TRUE}
# You want to make changes to your collaborators figure in Task 5. Maybe you want to create a figure that focuses only on three fish species instead of the 5. More specifically, chromis, lemon, and acantho. Add code here to revise their figure to do that.
```


# **Task 7**

# **Task 8**

# **Task 9**
Here, run some statistical tests to determine, for each species, whether the control vs high CO^2 treatments differ significantly from each other and in what direction. Provide the difference in means, their 95% confidence intervals, t-statistic, df and p-value. 

```{r, stats, echo=TRUE, eval=TRUE}
# Add your code here
```

```{r, table1, echo=TRUE, eval=TRUE, tab.cap = "write a caption here"}
# Using the resulting object created above, which should be a table with all the summary statistics, t, df and p-value for each species create a table. Note that there is a tab.cap argument in the chunk arguments. Write a caption here. 
```

Now that you have a table, you can reference it within a document. For example, you can make a call to Table \@ref(tab:table1) by referring to the name of the code chunk. When you knit the html it will create a hyperlink to your table and insert a legend above the table for you. How cool is that!?

